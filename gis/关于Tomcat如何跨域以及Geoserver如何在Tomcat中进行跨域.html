<!DOCTYPE html><html lang="zh-CN"><head><meta charset="utf-8"><meta name="X-UA-Compatible" content="IE=edge"><title> GeoServer如何在Tomcat中进行跨域 · yatsov的博客</title><meta name="description" content="GeoServer如何在Tomcat中进行跨域 - yatsov"><meta name="viewport" content="width=device-width, initial-scale=1"><link rel="icon" href="/favicon.png"><link rel="stylesheet" href="/css/apollo.css"><link rel="search" type="application/opensearchdescription+xml" href="http://yatsov.github.io/atom.xml" title="yatsov的博客"></head><body><div class="wrap"><header><a href="/" class="logo-link"><img src="/favicon.png" alt="logo"></a><ul class="nav nav-list"><li class="nav-list-item"><a href="/" target="_self" class="nav-list-link">BLOG</a></li><li class="nav-list-item"><a href="/archives/" target="_self" class="nav-list-link">目录</a></li><li class="nav-list-item"><a href="/categories/index.html" target="_self" class="nav-list-link">分类</a></li><li class="nav-list-item"><a href="https://github.com/yatsov/yatsov.github.io" target="_blank" class="nav-list-link">GITHUB</a></li><li class="nav-list-item"><a href="/about/index.html" target="_self" class="nav-list-link">关于</a></li><li class="nav-list-item"><a href="/work/index.html" target="_self" class="nav-list-link">作品</a></li></ul></header><main class="container"><div class="post"><article class="post-block"><h1 class="post-title">GeoServer如何在Tomcat中进行跨域</h1><div class="post-info">2018年5月2日</div><div class="post-content"><p>此处介绍了GeoServer如何在Tomcat中进行跨域<br><a id="more"></a></p>
<h2 id="GeoServer-的跨域"><a href="#GeoServer-的跨域" class="headerlink" title="GeoServer 的跨域"></a>GeoServer 的跨域</h2><p>GeoServer是一款Java系的地理信息服务器，功能强大，但是默认是war包安装的时候没有设置跨域有时候ajax是无法请求道图层数据的所以这里要进行跨域的设置。</p>
<blockquote>
<p>这里一定要注意一点！！！！！Tomcat的跨域设置和Jetty的跨域设置时不同的，类名不同的。而Geoserver的文档里写的容器默认是jetty，所以如果里面需要什么关于java容器的设置请自己再查一下对应的自己的容器是咋回事！！！切记。</p>
</blockquote>
<h2 id="Tomcat容器设置"><a href="#Tomcat容器设置" class="headerlink" title="Tomcat容器设置"></a>Tomcat容器设置</h2><h3 id="来源"><a href="#来源" class="headerlink" title="来源"></a>来源</h3><p><a href="https://tomcat.apache.org/tomcat-8.0-doc/config/filter.html#CORS_Filter/Introduction" target="_blank" rel="noopener">Tomcat官方配置文档</a></p>
<h3 id="CORS-Filter"><a href="#CORS-Filter" class="headerlink" title="CORS Filter"></a>CORS Filter</h3><p>他的原理是在HttpServletResponse对象中添加了Access-Control-*头。这个筛选器还保护了HTTP拆分。如果请求有问题或者不允许那么会返回403 (Forbidden)。下面介绍了配置项:</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">&lt;filter&gt;</span><br><span class="line">  &lt;filter-name&gt;CorsFilter&lt;/filter-name&gt;</span><br><span class="line">  &lt;filter-class&gt;org.apache.catalina.filters.CorsFilter&lt;/filter-class&gt;</span><br><span class="line">&lt;/filter&gt;</span><br><span class="line">&lt;filter-mapping&gt;</span><br><span class="line">  &lt;filter-name&gt;CorsFilter&lt;/filter-name&gt;</span><br><span class="line">  &lt;url-pattern&gt;/*&lt;/url-pattern&gt;</span><br><span class="line">&lt;/filter-mapping&gt;</span><br></pre></td></tr></table></figure>
<p>下面是几个initialisation parameters(init-param)(初始化参数)</p>
<h4 id="cors-allowed-origins"><a href="#cors-allowed-origins" class="headerlink" title="cors.allowed.origins"></a>cors.allowed.origins</h4><p>允许访问资源的起源列表。可以指定一个<em>以允许从任何来源访问资源。否则，可以提供逗号分隔的白名单。<br>例如: <a href="http://www.w3.org" target="_blank" rel="noopener">http://www.w3.org</a>, <a href="https://www.apache.org" target="_blank" rel="noopener">https://www.apache.org</a>.<br>默认: </em> (谁都行).</p>
<h4 id="cors-allowed-methods"><a href="#cors-allowed-methods" class="headerlink" title="cors.allowed.methods"></a>cors.allowed.methods</h4><p>这个用于控制请求的方法，这些方法也会包含在Access-Control-Allow-Methods头中。<br>例如: GET, POST.<br>默认: GET, POST, HEAD, OPTIONS</p>
<h4 id="cors-allowed-headers"><a href="#cors-allowed-headers" class="headerlink" title="cors.allowed.headers"></a>cors.allowed.headers</h4><p>这个用于控制请求头中所带的项，这个也会在预请求中作为Access-Control-Allow-Headers头的内容。<br>例如: Origin,Accept.<br>默认: Origin, Accept, X-Requested-With, Content-Type, Access-Control-Request-Method, Access-Control-Request-Headers</p>
<h4 id="cors-exposed-headers"><a href="#cors-exposed-headers" class="headerlink" title="cors.exposed.headers"></a>cors.exposed.headers</h4><p>这里面存着允许被暴露来的HTTP请求头，在Access-Control-Expose-Headers头中会显示。<br>例如: X-CUSTOM-HEADER-PING,X-CUSTOM-HEADER-PONG.<br>默认: None. Non-simple headers are not exposed by default.</p>
<h4 id="cors-preflight-maxage"><a href="#cors-preflight-maxage" class="headerlink" title="cors.preflight.maxage"></a>cors.preflight.maxage</h4><p>这个用秒计时，用于浏览器来缓存预请求的结果。这个会被包含在预请求结果的Access-Control-Max-Age头中。一个复制会阻止缓存。</p>
<p>默认: 1800</p>
<h4 id="cors-support-credentials"><a href="#cors-support-credentials" class="headerlink" title="cors.support.credentials"></a>cors.support.credentials</h4><p>是否支持缓存用户凭据，他在 Access-Control-Allow-Credentials头中被暴露出来。它帮助浏览器确定是否可以使用凭据来进行实际请求</p>
<p>默认: true</p>
<h4 id="cors-request-decorate"><a href="#cors-request-decorate" class="headerlink" title="cors.request.decorate"></a>cors.request.decorate</h4><p>要控制是否应该向HttpServletRequest对象添加CORS特定属性的标志。<br>Defaults: true</p>
<p>下面是一个完整的例子。<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line">&lt;filter&gt;</span><br><span class="line">  &lt;filter-name&gt;CorsFilter&lt;/filter-name&gt;</span><br><span class="line">  &lt;filter-class&gt;org.apache.catalina.filters.CorsFilter&lt;/filter-class&gt;</span><br><span class="line">  &lt;init-param&gt;</span><br><span class="line">    &lt;param-name&gt;cors.allowed.origins&lt;/param-name&gt;</span><br><span class="line">    &lt;param-value&gt;*&lt;/param-value&gt;</span><br><span class="line">  &lt;/init-param&gt;</span><br><span class="line">  &lt;init-param&gt;</span><br><span class="line">    &lt;param-name&gt;cors.allowed.methods&lt;/param-name&gt;</span><br><span class="line">    &lt;param-value&gt;GET,POST,HEAD,OPTIONS,PUT&lt;/param-value&gt;</span><br><span class="line">  &lt;/init-param&gt;</span><br><span class="line">  &lt;init-param&gt;</span><br><span class="line">    &lt;param-name&gt;cors.allowed.headers&lt;/param-name&gt;</span><br><span class="line">    &lt;param-value&gt;Content-Type,X-Requested-With,accept,Origin,Access-Control-Request-Method,Access-Control-Request-Headers&lt;/param-value&gt;</span><br><span class="line">  &lt;/init-param&gt;</span><br><span class="line">  &lt;init-param&gt;</span><br><span class="line">    &lt;param-name&gt;cors.exposed.headers&lt;/param-name&gt;</span><br><span class="line">    &lt;param-value&gt;Access-Control-Allow-Origin,Access-Control-Allow-Credentials&lt;/param-value&gt;</span><br><span class="line">  &lt;/init-param&gt;</span><br><span class="line">  &lt;init-param&gt;</span><br><span class="line">    &lt;param-name&gt;cors.support.credentials&lt;/param-name&gt;</span><br><span class="line">    &lt;param-value&gt;true&lt;/param-value&gt;</span><br><span class="line">  &lt;/init-param&gt;</span><br><span class="line">  &lt;init-param&gt;</span><br><span class="line">    &lt;param-name&gt;cors.preflight.maxage&lt;/param-name&gt;</span><br><span class="line">    &lt;param-value&gt;10&lt;/param-value&gt;</span><br><span class="line">  &lt;/init-param&gt;</span><br><span class="line">&lt;/filter&gt;</span><br><span class="line">&lt;filter-mapping&gt;</span><br><span class="line">  &lt;filter-name&gt;CorsFilter&lt;/filter-name&gt;</span><br><span class="line">  &lt;url-pattern&gt;/*&lt;/url-pattern&gt;</span><br><span class="line">&lt;/filter-mapping&gt;</span><br></pre></td></tr></table></figure></p>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><p>为geoserver配置跨域只要在他的app下面的web.xml里面修改web.xml即可注意一定要按照自己得容器规则修改。</p>
</div></article></div></main><footer><div class="paginator"><a href="/gis/JTS 基础-2.html" class="prev">上一篇</a><a href="/gis/Openlayers与React结合2.html" class="next">下一篇</a></div><div class="copyright"><p>© 2016 - 2018 <a href="http://yatsov.github.io">yatsov</a>, powered by <a href="https://hexo.io/" target="_blank">Hexo</a> and <a href="https://github.com/pinggod/hexo-theme-apollo" target="_blank">hexo-theme-apollo</a>.</p></div></footer></div><script async src="//cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML" integrity="sha384-crwIf/BuaWM9rM65iM+dWFldgQ1Un8jWZMuh3puxb8TOY9+linwLoI7ZHZT+aekW" crossorigin="anonymous"></script></body></html>